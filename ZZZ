import os

choice = input ("Would you like to (A) enter a single file or (B) enter a directory: ")
if choice.upper() == "A":
    files = os.listdir(os.curdir)
    for file_name in files:
        print(file_name) # Prints all of the files in the directory.
    filename = input("Please specify file from one of the options above: ")
    while filename not in files: # Checks if specified filename is in directory.
        filename = input("Filename Invalid. Please type a valid filename: ") 
        word_input = input("Please specify word to be counted: ")
    if len(word_input.strip().split(" ")) > 2: # Removes whitepsace and separates words into array. Checks if there are more than two words.
        raise Exception("You typed more that two words. This is not allowed.")
    case_sensitive = input("Please type 1 for case-sensitive or 0 for case insensitive: ")
    count = 0

    with open(filename) as file:
        # Line below removes punctuation
        file_contents = file.read().replace(",", " ").replace(".", " ").replace("!", " ").replace("\n", " ").replace("?", " ").replace(":", " ")
        if not int(case_sensitive):
            word_input = word_input.lower()
            file_contents = file_contents.lower() # Line 40 and 41 handle case insensitivity by changing words to lowercase
        file_contents = file_contents.split(" ")
        count = sum(1 for word in file_contents of word == word_input)
    results = f"The word {word_input} was found {count} times in this file: {filename}"
    print(results)

    with open("wordcount_result.txt", "w") as file:
        file.write(results) # Writes results to wordcount_results.txt file.

if choice == "B":
    for file_name in files:
        with open(filename) as file:
        # Line below removes punctuation
            file_contents = file.read().replace(",", " ").replace(".", " ").replace("!", " ").replace("\n", " ").replace("?", " ").replace(":", " ")
            if not int(case_sensitive):
                word_input = word_input.lower()
                file_contents = file_contents.lower() # Line 40 and 41 handle case insensitivity by changing words to lowercase
                file_contents = file_contents.split(" ")
            for word in file_contents:
                if word == word_input:
                    count += 1  # Counts words in the file that match specified file.
